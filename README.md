# CryptographyTProjects

This repository includes various small projects about cryptography algorithm implementations (e.g. encryption and attack) introduced in Dan Boneh **Cryptography I** course, Stanford University. 

***many_time_pad.py***: Many-Time Pad Attack. Single stream cipher should never be used to encrypt multiple messages. Given a collection of 11 hex-encoded ciphertexts that are the result of encrypting 11 plaintext messages with the same one-time pad. Based on that, we could decrypt the last ciphertext and obtain the secret message. XOR the ciphertexts together, and consider what happens when space is XORed with a character in [a-z A-Z].

***cbc_ctr.py***: Implement two classical encryption/decryption systems (AES-CBC and AES-CTR) separately. 16-byte encryption IV is chosen at random and is prepended to the ciphertext. For CBC encryption we use the PKCS5 padding scheme. Given an AES key and a ciphertext (hex-encoded), we aim to recover the plaintext. 

***sha256.py***: Build a file authentication system that lets browsers authenticate and play video chunks as they are downloaded without having to wait for the entire file. Instead of computing a hash of the entire file, the website breaks the file into 1KB block (1024 bytes). It computes the hash of the last block and appends the value to the second to last block (recursively doing that). The final hash value h0 – a hash of the first block with its appended hash – is distributed to users via the authenticated channel. When the first block (B0||h1) is received, the browser could check whether it is equal to h0 and if so it begins playing the first video block. If the hash function H is collision-resistant, then the attacker cannot modify any of the video blocks without being detected by the browser. Therefore after the first hash check, the browser is convinced that both B0 and h1 are authentic, and so on for the remaining blocks. 

***padding_oracle_attack.py***: Experiment with a padding oracle attack against a toy web site hosted at *crypto-class.appspot.com*. Padding oracle vulnerabilities affect a wide variety of products, including secure tokens. The website is vulnerable to a CBC padding oracle attack. When a decrypted CBC ciphertext ends in an invalid pad the webserver returns a 403 error code (forbidden request). When the CBC padding is valid, but the message is malformed, the webserver returns a 404 error code (URL not found). To decrypt a single byte, we need to send up to 256 HTTP requests to the site.  The first ciphertext block is the random IV. The decrypted message is ASCII encoded. From this project, we understand that when using encryption we must prevent padding oracle attacks by either using encrypt-then-MAC as in EAX or GCM. Also, if we must use MAC-then-encrypt, then ensure that the site treats padding errors the same way it treats MAC errors.

***discrete_log.py***: Compute discrete log modulo a prime p. Let g be some elements in Zp* and suppose you are given h in Zp* such that h = g^x where 1 <= x <= 2^40. We aim to find x given the input of p, g, h. We can write the unknown x base B as x = x0 * B + x1 and deduce that h/(g^x1) = (g^B)^x0 in Zp. In our case B = 2^20. First, we build a hash table of all possible values of the left-hand side h/(g^x1) for x1 = 0, 1, ..., 2^20. Then for each value x0 = 0, 1, ..., 2^20 check if the right-hand side (g^B)^x0 is in this hash table. If so, then (x0, x1) is found as a valid solution. The overall work requires 2^20 multiplications to build the table and another 2^20 lookups in this table. 

***break_rsa_factor.py***: Break RSA when the public modulus N is generated incorrectly. Suppose given a composite N as a product of two relatively close primes p and q such that |p-q| < 2N^(1/4). We could factor N easily by using A as the arithmetic average of the two primes (A = ceil(sqrt(N))). As an extension, we could encrypt a short secret ASCII plaintext using the RSA modulus. The plaintext is encoded using PKCS v1.5 before the RSA function was applied, as described in PKCS. The separator here is 0x00. 
